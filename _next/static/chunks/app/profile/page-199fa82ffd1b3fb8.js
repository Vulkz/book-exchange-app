(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{5983:function(e,a,s){Promise.resolve().then(s.bind(s,112))},112:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return j}});var r=s(7437),i=s(2265),t=s(9376),l=s(5452),o=s(6128),n=s(9703),c=s(173),d=s(6070),m=s(5186),u=s(2869),x=s(6818),p=s(6815),h=s(7992),g=s(1769),f=s(2369);function j(){let{user:e,loading:a,signOut:s}=(0,o.a)(),[j,b]=(0,i.useState)(null),[v,y]=(0,i.useState)(!0),[N,_]=(0,i.useState)(!1),[E,w]=(0,i.useState)(!1),[C,S]=(0,i.useState)({display_name:"",bio:"",location:""}),A=(0,t.useRouter)(),k=(0,l.createClientComponentClient)();(0,i.useEffect)(()=>{a||(e?z():y(!1))},[e,a]);let z=async()=>{try{if(!e){y(!1);return}let{data:a,error:s}=await k.from("profiles").select("*").eq("user_id",e.id).single();if(s){console.error("Error loading profile:",s),(0,h.Am)({title:"Erro",description:"Erro ao carregar perfil",variant:"destructive"});return}b(a),S({display_name:a.display_name||"",bio:a.bio||"",location:a.location||""})}catch(e){console.error("Error:",e),(0,h.Am)({title:"Erro",description:"Erro ao carregar dados do usu\xe1rio",variant:"destructive"})}finally{y(!1)}},F=async()=>{await s(),A.push("/")},I=(e,a)=>{S(s=>({...s,[e]:a}))},O=async a=>{if(a.preventDefault(),!e){(0,h.Am)({title:"Erro",description:"Usu\xe1rio n\xe3o encontrado",variant:"destructive"});return}_(!0);try{let{error:a}=await k.from("profiles").update({display_name:C.display_name,bio:C.bio,location:C.location}).eq("id",e.id);if(a){console.error("Error updating profile:",a),(0,h.Am)({title:"Erro",description:"Erro ao salvar perfil",variant:"destructive"});return}(0,h.Am)({title:"Sucesso!",description:"Perfil atualizado com sucesso"}),await z()}catch(e){console.error("Error:",e),(0,h.Am)({title:"Erro",description:"Erro inesperado ao salvar",variant:"destructive"})}finally{_(!1)}};return a||v?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(g.Z,{className:"h-12 w-12 text-blue-600 animate-pulse mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Carregando..."})]})}):e?(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:[(0,r.jsx)(n.W,{userId:e.id,onAddBook:()=>w(!0),onLogout:F}),(0,r.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,r.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Meu Perfil"}),(0,r.jsxs)(d.Zb,{children:[(0,r.jsx)(d.Ol,{children:(0,r.jsx)(d.ll,{children:"Informa\xe7\xf5es Pessoais"})}),(0,r.jsx)(d.aY,{children:(0,r.jsxs)("form",{onSubmit:O,className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(p._,{htmlFor:"email",children:"Email"}),(0,r.jsx)(m.I,{id:"email",type:"email",value:(null==e?void 0:e.email)||"",disabled:!0,className:"bg-gray-50"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"O email n\xe3o pode ser alterado"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(p._,{htmlFor:"display_name",children:"Nome de Exibi\xe7\xe3o *"}),(0,r.jsx)(m.I,{id:"display_name",type:"text",value:C.display_name,onChange:e=>I("display_name",e.target.value),placeholder:"Como voc\xea quer ser chamado",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(p._,{htmlFor:"bio",children:"Biografia"}),(0,r.jsx)(x.g,{id:"bio",value:C.bio,onChange:e=>I("bio",e.target.value),placeholder:"Conte um pouco sobre voc\xea, seus interesses liter\xe1rios...",rows:4})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(p._,{htmlFor:"location",children:"Localiza\xe7\xe3o"}),(0,r.jsx)(m.I,{id:"location",type:"text",value:C.location,onChange:e=>I("location",e.target.value),placeholder:"Sua cidade/regi\xe3o"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Ajuda outros usu\xe1rios a encontrar voc\xea para trocas"})]}),j&&(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,r.jsx)("h3",{className:"font-semibold mb-2",children:"Estat\xedsticas"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Membro desde: ",new Date(j.created_at).toLocaleDateString("pt-BR")]})]}),(0,r.jsx)(u.z,{type:"submit",disabled:N,className:"w-full",children:N?"Salvando...":"Salvar Altera\xe7\xf5es"})]})})]})]})}),E&&(0,r.jsx)(c.k,{isOpen:E,onClose:()=>w(!1),onSuccess:()=>{w(!1)}})]}):(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-md",children:[(0,r.jsx)(f.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Acesso Restrito"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"Voc\xea precisa estar logado para acessar seu perfil."}),(0,r.jsx)(u.z,{onClick:()=>A.push("/"),className:"w-full",children:"Fazer Login"})]})})})}}},function(e){e.O(0,[452,614,789,971,117,744],function(){return e(e.s=5983)}),_N_E=e.O()}]);