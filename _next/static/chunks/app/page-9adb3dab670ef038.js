(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9050:function(e,s,a){Promise.resolve().then(a.bind(a,5864))},5864:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return B}});var r=a(7437),t=a(2265),o=a(5452),i=a(6128),l=a(9703),n=a(2489),d=a(3417),c=a(3774),m=a(4743),u=a(9376);function x(e){var s,a,l;let{isOpen:x,onClose:h,book:g,onRequestSent:p}=e,[f,v]=(0,t.useState)(""),[b,j]=(0,t.useState)(""),[w,N]=(0,t.useState)([]),[y,_]=(0,t.useState)(!1),[E,S]=(0,t.useState)(""),C=(0,o.createClientComponentClient)(),{user:k,loading:q}=(0,i.a)(),D=(0,u.useRouter)();(0,t.useEffect)(()=>{x&&console.log("BookRequestModal - Estado da autentica\xe7\xe3o:",{user:k?{id:k.id,email:k.email}:null,authLoading:q,isOpen:x})},[x,k,q]),(0,t.useEffect)(()=>{x&&P()},[x]);let P=async()=>{try{let{data:e,error:s}=await C.from("meeting_locations").select("*").eq("book_id",g.id).order("location");if(s)throw s;let a=(null==e?void 0:e.map(e=>({id:e.id,name:e.location,description:e.location,address:e.location})))||[];N(a)}catch(e){console.error("Erro ao buscar locais de encontro:",e)}},L=async e=>{if(e.preventDefault(),0===w.length){S("Este livro n\xe3o possui locais de encontro definidos pelo propriet\xe1rio");return}if(!f.trim()||!b){S("Por favor, preencha todos os campos");return}if(f.length>500){S("A mensagem deve ter no m\xe1ximo 500 caracteres");return}_(!0),S("");try{var s,a,r,t,o,i;if(console.log("=== VERIFICA\xc7\xc3O R\xc1PIDA DE AUTENTICA\xc7\xc3O ==="),!(null==k?void 0:k.id))throw Error("Usu\xe1rio n\xe3o autenticado. Fa\xe7a login novamente.");let{data:{session:e},error:l}=await C.auth.getSession();if(l)throw console.error("Erro na sess\xe3o:",l),Error("Erro de autentica\xe7\xe3o. Tente novamente.");if(!e)throw Error("Sess\xe3o expirada. Fa\xe7a logout e login novamente.");console.log("✅ Usu\xe1rio autenticado:",{userId:k.id,email:k.email,sessionExpires:e.expires_at?new Date(1e3*e.expires_at).toLocaleString():"indefinido"});let n=(null===(s=w.find(e=>e.id===b))||void 0===s?void 0:s.name)||b,d={book_id:g.id,requester_id:k.id,owner_id:g.owner_id,message:f.trim(),status:"pendente"};console.log("Dados para inser\xe7\xe3o:",d),d.message="".concat(f.trim(),"\n\n[Local preferido: ").concat(n,"]"),console.log("\uD83D\uDCDD Inserindo solicita\xe7\xe3o na tabela requests...",d);let{data:c,error:m}=await C.from("requests").insert(d).select();if(console.log("✅ Resultado da inser\xe7\xe3o em requests:",{success:!m,data:c,error:m,insertData:d}),m){if(console.error("❌ Erro detalhado na inser\xe7\xe3o em requests:",m),null===(a=m.message)||void 0===a?void 0:a.includes("meeting_locations"))throw console.error("\uD83D\uDEA8 ERRO EM MEETING_LOCATIONS - isso \xe9 estranho, n\xe3o deveria estar criando meeting_locations aqui!"),console.error("Dados que causaram o erro:",d),Error("Erro inesperado: tentativa de criar meeting_locations durante solicita\xe7\xe3o de livro");throw m}console.log("✅ Solicita\xe7\xe3o inserida com sucesso na tabela requests!");try{console.log("\uD83D\uDCE7 Iniciando cria\xe7\xe3o de notifica\xe7\xe3o...");let e=(null===(r=k.user_metadata)||void 0===r?void 0:r.display_name)||(null===(t=k.user_metadata)||void 0===t?void 0:t.name)||(null===(o=k.email)||void 0===o?void 0:o.split("@")[0])||"Usu\xe1rio",s={user_id:g.owner_id,type:"book_request",title:"Nova solicita\xe7\xe3o de livro",message:"".concat(e,' solicitou o livro "').concat(g.title,'". Local preferido: ').concat(n),read:!1,data:{request_id:(null==c?void 0:null===(i=c[0])||void 0===i?void 0:i.id)||null,book_id:g.id,requester_id:k.id,requester_name:e}};console.log("\uD83D\uDCE7 Inserindo notifica\xe7\xe3o...",s);let{error:a}=await C.from("notifications").insert(s);console.log("\uD83D\uDCE7 Resultado da inser\xe7\xe3o de notifica\xe7\xe3o:",{success:!a,error:a}),a?console.error("Erro ao criar notifica\xe7\xe3o:",a):console.log("✅ Notifica\xe7\xe3o criada com sucesso!")}catch(e){console.error("Erro inesperado ao criar notifica\xe7\xe3o:",e)}alert("✅ Solicita\xe7\xe3o enviada com sucesso! Voc\xea ser\xe1 redirecionado para ver suas solicita\xe7\xf5es."),p(),h(),v(""),j(""),console.log("Redirecionando para /requests?tab=enviadas..."),setTimeout(()=>{D.push("/requests?tab=enviadas")},500)}catch(e){S(e.message||"Erro ao enviar solicita\xe7\xe3o")}finally{_(!1)}},I=()=>{h(),v(""),j(""),S("")};return x?q||!k?(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,r.jsx)("div",{className:"bg-white rounded-lg max-w-md w-full p-6 text-center",children:q?(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,r.jsx)("p",{children:"Verificando autentica\xe7\xe3o..."})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)(n.Z,{className:"h-8 w-8 text-red-500 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"Voc\xea precisa estar logado para solicitar livros."}),(0,r.jsx)("button",{onClick:I,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Fechar"})]})})}):(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(d.Z,{className:"h-6 w-6 text-blue-600"}),(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Solicitar Livro"})]}),(0,r.jsx)("button",{onClick:I,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,r.jsx)(n.Z,{className:"h-5 w-5"})})]}),(0,r.jsxs)("div",{className:"p-6 border-b bg-gray-50",children:[(0,r.jsx)("h3",{className:"font-semibold text-lg text-gray-900",children:g.title}),(0,r.jsxs)("p",{className:"text-gray-600",children:["por ",g.author]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Dono: ",(null===(s=g.owner)||void 0===s?void 0:s.display_name)||"Usu\xe1rio"]})]}),(0,r.jsxs)("form",{onSubmit:L,className:"p-6",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensagem para o dono do livro *"}),(0,r.jsx)("textarea",{id:"message",value:f,onChange:e=>v(e.target.value),placeholder:"Conte um pouco sobre voc\xea, por que est\xe1 interessado neste livro, quando gostaria de peg\xe1-lo emprestado...",className:"w-full p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:4,maxLength:500,required:!0}),(0,r.jsxs)("div",{className:"flex justify-between mt-2",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"M\xe1ximo 500 caracteres"}),(0,r.jsxs)("p",{className:"text-sm ".concat(f.length>450?"text-red-500":"text-gray-500"),children:[f.length,"/500"]})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,r.jsx)(c.Z,{className:"h-4 w-4 inline mr-1"}),"Local de encontro *"]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Escolha um dos locais disponibilizados por ",(null===(a=g.owner)||void 0===a?void 0:a.display_name)||"o propriet\xe1rio",":"]}),w.length>0?(0,r.jsxs)("select",{id:"location",value:b,onChange:e=>j(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Selecione um local"}),w.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]}):(0,r.jsx)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,r.jsx)("p",{className:"text-sm text-yellow-800",children:"O propriet\xe1rio ainda n\xe3o definiu locais de encontro para este livro."})}),b&&(0,r.jsxs)("p",{className:"text-sm text-blue-600 mt-2 p-2 bg-blue-50 rounded",children:["\uD83D\uDCCD Local selecionado: ",null===(l=w.find(e=>e.id===b))||void 0===l?void 0:l.name]})]}),E&&(0,r.jsxs)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,r.jsx)("p",{className:"text-sm text-red-600",children:E}),E.includes("sess\xe3o expirou")&&(0,r.jsx)("button",{onClick:()=>window.location.href="/login",className:"mt-2 text-sm text-blue-600 underline hover:text-blue-800",children:"Ir para a p\xe1gina de login"})]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:I,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),(0,r.jsx)("button",{type:"submit",disabled:y||!f.trim()||!b||0===w.length,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center justify-center space-x-2",children:y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("span",{children:"Enviando..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Enviar Solicita\xe7\xe3o"})]})})]})]}),(0,r.jsx)("div",{className:"p-4 bg-blue-50 border-t",children:(0,r.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,r.jsx)(d.Z,{className:"h-4 w-4 inline mr-1"}),"Sua solicita\xe7\xe3o ser\xe1 enviada ao dono do livro. Voc\xea receber\xe1 uma notifica\xe7\xe3o quando ele responder."]})})]})}):null}var h=a(173),g=a(970),p=a(5427),f=a(2869),v=a(6070),b=a(5186),j=a(6815),w=a(2339),N=a(3966),y=a(6606),_=a(1188),E=a(6840),S="Avatar",[C,k]=(0,N.b)(S),[q,D]=C(S),P=t.forwardRef((e,s)=>{let{__scopeAvatar:a,...o}=e,[i,l]=t.useState("idle");return(0,r.jsx)(q,{scope:a,imageLoadingStatus:i,onImageLoadingStatusChange:l,children:(0,r.jsx)(E.WV.span,{...o,ref:s})})});P.displayName=S;var L="AvatarImage";t.forwardRef((e,s)=>{let{__scopeAvatar:a,src:o,onLoadingStatusChange:i=()=>{},...l}=e,n=D(L,a),d=function(e,s){let[a,r]=t.useState("idle");return(0,_.b)(()=>{if(!e){r("error");return}let a=!0,t=new window.Image,o=e=>()=>{a&&r(e)};return r("loading"),t.onload=o("loaded"),t.onerror=o("error"),t.src=e,s&&(t.referrerPolicy=s),()=>{a=!1}},[e,s]),a}(o,l.referrerPolicy),c=(0,y.W)(e=>{i(e),n.onImageLoadingStatusChange(e)});return(0,_.b)(()=>{"idle"!==d&&c(d)},[d,c]),"loaded"===d?(0,r.jsx)(E.WV.img,{...l,ref:s,src:o}):null}).displayName=L;var I="AvatarFallback",R=t.forwardRef((e,s)=>{let{__scopeAvatar:a,delayMs:o,...i}=e,l=D(I,a),[n,d]=t.useState(void 0===o);return t.useEffect(()=>{if(void 0!==o){let e=window.setTimeout(()=>d(!0),o);return()=>window.clearTimeout(e)}},[o]),n&&"loaded"!==l.imageLoadingStatus?(0,r.jsx)(E.WV.span,{...i,ref:s}):null});R.displayName=I;var O=a(4508);function F(e){let{className:s,...a}=e;return(0,r.jsx)(P,{"data-slot":"avatar",className:(0,O.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",s),...a})}function U(e){let{className:s,...a}=e;return(0,r.jsx)(R,{"data-slot":"avatar-fallback",className:(0,O.cn)("bg-muted flex size-full items-center justify-center rounded-full",s),...a})}var Z=a(5974),z=a(1769),T=a(9205);let A=(0,T.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),V=(0,T.Z)("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);var M=a(3145);let Q=e=>{let s={};return e.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)||(s.email="Email inv\xe1lido"):s.email="Email \xe9 obrigat\xf3rio",e.password?e.password.length<6&&(s.password="Senha deve ter pelo menos 6 caracteres"):s.password="Senha \xe9 obrigat\xf3ria",{success:0===Object.keys(s).length,errors:s}},W=e=>{let s={};return e.name?e.name.length<2&&(s.name="Nome deve ter pelo menos 2 caracteres"):s.name="Nome \xe9 obrigat\xf3rio",e.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)||(s.email="Email inv\xe1lido"):s.email="Email \xe9 obrigat\xf3rio",e.password?e.password.length<6&&(s.password="Senha deve ter pelo menos 6 caracteres"):s.password="Senha \xe9 obrigat\xf3ria",e.confirmPassword?e.password!==e.confirmPassword&&(s.confirmPassword="Senhas n\xe3o coincidem"):s.confirmPassword="Confirma\xe7\xe3o de senha \xe9 obrigat\xf3ria",{success:0===Object.keys(s).length,errors:s}};function B(){let{user:e,session:s,loading:a,signOut:n}=(0,i.a)(),[d,m]=(0,t.useState)(null),[u,N]=(0,t.useState)(!0),[y,_]=(0,t.useState)({email:"",password:"",name:"",confirmPassword:""}),[E,S]=(0,t.useState)({}),[C,k]=(0,t.useState)(!1),[q,D]=(0,t.useState)(null),[P,L]=(0,t.useState)(!1),[I,R]=(0,t.useState)(!1),[O,T]=(0,t.useState)(""),B=(0,o.createClientComponentClient)(),{books:G,loading:Y}=function(){let[e,s]=(0,t.useState)([]),[a,r]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{(async()=>{try{let{data:{user:e}}=await g.OQ.auth.getUser(),a=g.OQ.from("books").select("\n            *,\n            owner:profiles(display_name, location)\n          ").eq("availability_status","available").order("created_at",{ascending:!1});e&&a.neq("owner_id",e.id);let{data:r,error:t}=await a;if(t)throw t;s(r||[])}catch(e){console.error("Erro ao buscar livros:",e)}finally{r(!1)}})()},[]),(0,t.useEffect)(()=>{let e=g.OQ.channel("books").on("postgres_changes",{event:"INSERT",schema:"public",table:"books"},async e=>{let a=e.new,{data:{user:r}}=await g.OQ.auth.getUser();"available"===a.availability_status&&a.owner_id!==(null==r?void 0:r.id)&&s(e=>[a,...e])}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"books"},async e=>{let a=e.new,{data:{user:r}}=await g.OQ.auth.getUser();s(e=>e.map(e=>e.id===a.id?a:e).filter(e=>"available"===e.availability_status&&e.owner_id!==(null==r?void 0:r.id)))}).on("postgres_changes",{event:"DELETE",schema:"public",table:"books"},e=>{let a=e.old;s(e=>e.filter(e=>e.id!==a.id))}).subscribe();return()=>{g.OQ.removeChannel(e)}},[]),{books:e,loading:a,refreshBooks:()=>{r(!0)}}}(),{createRequest:$}=(0,p.X)((null==e?void 0:e.id)||"");(0,t.useEffect)(()=>{e?H(e.id):m(null)},[e]);let H=async e=>{try{let{data:s,error:a}=await B.from("profiles").select("*").eq("id",e).single();if(a){if("PGRST116"===a.code)console.log("Profile not found, will be created on first interaction");else throw a}else m(s)}catch(e){console.error("Error fetching profile:",e)}},X=e=>{let{name:s,value:a}=e.target;_(e=>({...e,[s]:a})),E[s]&&S(e=>({...e,[s]:""}))},J=async e=>{e.preventDefault(),k(!0),S({});try{var s;let e=Q(y);if(!e.success){S(e.errors);return}let{data:a,error:r}=await B.auth.signInWithPassword({email:y.email,password:y.password});console.log("Login attempt result:",{success:!r,error:null==r?void 0:r.message,session:a.session?{user_id:null===(s=a.session.user)||void 0===s?void 0:s.id,expires_at:a.session.expires_at,access_token:a.session.access_token?"presente":"ausente"}:null}),r?S({general:r.message}):(console.log("Login successful:",a),_({email:"",password:"",name:"",confirmPassword:""}))}catch(e){console.error("Login error:",e),S({general:"Erro inesperado. Tente novamente."})}finally{k(!1)}},K=async e=>{e.preventDefault(),k(!0),S({});try{let e=W(y);if(!e.success){S(e.errors);return}let{data:s,error:a}=await B.auth.signUp({email:y.email,password:y.password,options:{data:{name:y.name}}});a?S({general:a.message}):(console.log("Registration successful:",s),s.user&&!s.session&&alert("Verifique seu email para confirmar sua conta!"),_({email:"",password:"",name:"",confirmPassword:""}))}catch(e){console.error("Registration error:",e),S({general:"Erro inesperado. Tente novamente."})}finally{k(!1)}},ee=s=>{if(!e){alert("Voc\xea precisa estar logado para solicitar livros!");return}D(s),L(!0)},es=async()=>{await n()},ea=G.filter(e=>{var s;if(!O.trim())return!0;let a=O.toLowerCase();return e.title.toLowerCase().includes(a)||e.author.toLowerCase().includes(a)||e.description.toLowerCase().includes(a)||e.category.toLowerCase().includes(a)||(null===(s=e.owner)||void 0===s?void 0:s.display_name.toLowerCase().includes(a))});return a?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(z.Z,{className:"h-12 w-12 text-blue-600 animate-pulse mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Carregando..."})]})}):e?(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:[(0,r.jsx)(l.W,{userId:e.id,onAddBook:()=>R(!0),onLogout:es}),(0,r.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Livros Dispon\xedveis"}),O.trim()&&(0,r.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[ea.length," resultado",1!==ea.length?"s":"",' para "',O,'"']})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(A,{className:"h-5 w-5 text-gray-400"}),(0,r.jsx)(b.I,{type:"search",placeholder:"Buscar por t\xedtulo, autor, categoria...",className:"w-80",value:O,onChange:e=>T(e.target.value)}),O.trim()&&(0,r.jsx)(f.z,{variant:"ghost",size:"sm",onClick:()=>T(""),className:"text-gray-500",children:"Limpar"})]})]}),Y?(0,r.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:[1,2,3,4,5,6,7,8].map(e=>(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"bg-gray-200 rounded-lg h-64 mb-4"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})]},e))}):0===ea.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(z.Z,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:O.trim()?"Nenhum livro encontrado":"Nenhum livro dispon\xedvel"}),(0,r.jsx)("p",{className:"text-gray-500",children:O.trim()?'N\xe3o encontramos livros para "'.concat(O,'". Tente outros termos.'):"Seja o primeiro a adicionar um livro!"})]}):(0,r.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:ea.map(s=>{var a,t,o;return(0,r.jsxs)(v.Zb,{className:"group hover:shadow-lg transition-shadow overflow-hidden",children:[(0,r.jsxs)("div",{className:"aspect-[3/4] relative",children:[s.image_url?(0,r.jsx)(M.default,{src:s.image_url,alt:s.title,fill:!0,className:"object-cover group-hover:scale-105 transition-transform duration-200"}):(0,r.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center",children:(0,r.jsx)(z.Z,{className:"h-12 w-12 text-blue-500"})}),(0,r.jsx)("div",{className:"absolute top-2 right-2",children:(0,r.jsx)(Z.C,{className:"bg-white/90 text-gray-700 shadow-sm",children:s.category||"Livro"})})]}),(0,r.jsxs)(v.aY,{className:"p-4",children:[(0,r.jsx)("h3",{className:"font-semibold text-lg mb-1 line-clamp-1",children:s.title}),(0,r.jsxs)("p",{className:"text-gray-600 mb-2",children:["por ",s.author]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:s.description}),s.owner&&(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(F,{className:"h-6 w-6",children:(0,r.jsx)(U,{className:"text-xs",children:(null===(t=s.owner.display_name)||void 0===t?void 0:null===(a=t[0])||void 0===a?void 0:a.toUpperCase())||"U"})}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:s.owner.display_name})]}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["Propriet\xe1rio: ",(null===(o=s.owner)||void 0===o?void 0:o.display_name)||"Usu\xe1rio"]})]}),s.meeting_locations&&s.meeting_locations.length>0&&(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center text-gray-500 text-xs mb-1",children:[(0,r.jsx)(c.Z,{className:"h-3 w-3 mr-1"}),"Locais de encontro:"]}),(0,r.jsxs)("p",{className:"text-xs text-gray-600",children:[s.meeting_locations.slice(0,2).join(", "),s.meeting_locations.length>2&&" +".concat(s.meeting_locations.length-2)]})]}),(0,r.jsxs)(f.z,{onClick:()=>ee(s),className:"w-full",size:"sm",disabled:!e,title:e?void 0:"Fa\xe7a login para solicitar livros",children:[(0,r.jsx)(V,{className:"h-4 w-4 mr-2"}),e?"Solicitar":"Fa\xe7a login para solicitar"]})]})]},s.id)})})]})}),q&&(0,r.jsx)(x,{book:q,isOpen:P,onClose:()=>{L(!1),D(null)},onRequestSent:()=>{L(!1),D(null)}}),I&&(0,r.jsx)(h.k,{isOpen:I,onClose:()=>R(!1),onSuccess:()=>{R(!1)}})]}):(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:(0,r.jsxs)(v.Zb,{className:"w-full max-w-md",children:[(0,r.jsxs)(v.Ol,{className:"text-center",children:[(0,r.jsx)("div",{className:"mx-auto bg-blue-600 rounded-full p-3 w-16 h-16 flex items-center justify-center mb-4",children:(0,r.jsx)(z.Z,{className:"h-8 w-8 text-white"})}),(0,r.jsx)(v.ll,{className:"text-2xl",children:"BookShare"}),(0,r.jsx)(v.SZ,{children:u?"Entre na sua conta":"Crie sua conta"})]}),(0,r.jsx)(v.aY,{children:(0,r.jsxs)(w.mQ,{value:u?"login":"register",onValueChange:e=>N("login"===e),children:[(0,r.jsxs)(w.dr,{className:"grid w-full grid-cols-2",children:[(0,r.jsx)(w.SP,{value:"login",children:"Entrar"}),(0,r.jsx)(w.SP,{value:"register",children:"Registrar"})]}),(0,r.jsx)(w.nU,{value:"login",className:"space-y-4",children:(0,r.jsxs)("form",{onSubmit:J,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(j._,{htmlFor:"email",children:"Email"}),(0,r.jsx)(b.I,{id:"email",name:"email",type:"email",value:y.email,onChange:X,className:E.email?"border-red-500":"",required:!0}),E.email&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:E.email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(j._,{htmlFor:"password",children:"Senha"}),(0,r.jsx)(b.I,{id:"password",name:"password",type:"password",value:y.password,onChange:X,className:E.password?"border-red-500":"",required:!0}),E.password&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:E.password})]}),E.general&&(0,r.jsx)("p",{className:"text-sm text-red-500",children:E.general}),(0,r.jsx)(f.z,{type:"submit",className:"w-full",disabled:C,children:C?"Entrando...":"Entrar"})]})}),(0,r.jsx)(w.nU,{value:"register",className:"space-y-4",children:(0,r.jsxs)("form",{onSubmit:K,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(j._,{htmlFor:"name",children:"Nome"}),(0,r.jsx)(b.I,{id:"name",name:"name",type:"text",value:y.name,onChange:X,className:E.name?"border-red-500":"",required:!0}),E.name&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:E.name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(j._,{htmlFor:"email",children:"Email"}),(0,r.jsx)(b.I,{id:"email",name:"email",type:"email",value:y.email,onChange:X,className:E.email?"border-red-500":"",required:!0}),E.email&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:E.email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(j._,{htmlFor:"password",children:"Senha"}),(0,r.jsx)(b.I,{id:"password",name:"password",type:"password",value:y.password,onChange:X,className:E.password?"border-red-500":"",required:!0}),E.password&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:E.password})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(j._,{htmlFor:"confirmPassword",children:"Confirmar Senha"}),(0,r.jsx)(b.I,{id:"confirmPassword",name:"confirmPassword",type:"password",value:y.confirmPassword,onChange:X,className:E.confirmPassword?"border-red-500":"",required:!0}),E.confirmPassword&&(0,r.jsx)("p",{className:"text-sm text-red-500 mt-1",children:E.confirmPassword})]}),E.general&&(0,r.jsx)("p",{className:"text-sm text-red-500",children:E.general}),(0,r.jsx)(f.z,{type:"submit",className:"w-full",disabled:C,children:C?"Registrando...":"Registrar"})]})})]})})]})})}},2339:function(e,s,a){"use strict";a.d(s,{SP:function(){return n},dr:function(){return l},mQ:function(){return i},nU:function(){return d}});var r=a(7437);a(2265);var t=a(9707),o=a(4508);function i(e){let{className:s,...a}=e;return(0,r.jsx)(t.fC,{"data-slot":"tabs",className:(0,o.cn)("flex flex-col gap-2",s),...a})}function l(e){let{className:s,...a}=e;return(0,r.jsx)(t.aV,{"data-slot":"tabs-list",className:(0,o.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",s),...a})}function n(e){let{className:s,...a}=e;return(0,r.jsx)(t.xz,{"data-slot":"tabs-trigger",className:(0,o.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...a})}function d(e){let{className:s,...a}=e;return(0,r.jsx)(t.VY,{"data-slot":"tabs-content",className:(0,o.cn)("flex-1 outline-none",s),...a})}}},function(e){e.O(0,[452,614,145,590,789,971,117,744],function(){return e(e.s=9050)}),_N_E=e.O()}]);